<!DOCTYPE html>
<html>
<head>
	<title>Maze</title>
	<meta charset="utf-8" />
	<link rel="stylesheet" href="css/styles.css" />
</head>
<body>
	<main id="app">
		<div id="editor" style="font-size: 16px">const step = (up, left, right, down, from) => {
  const from_index = ['left', 'up', 'right', 'down'].indexOf(from);

  const allowed = [up, right, down, left, up, right, down, left];
  return ['up', 'right', 'down', 'left', 'up', 'right', 'down', 'left']
      .find((dir, i) => i >= from_index && allowed[i]);
};</div>
		<div id="maze" class="maze"></div>
		<button id="start-btn">Play</button>
	</main>
	<script src="./node_modules/ace-builds/src-min-noconflict/ace.js" type="text/javascript"></script>
	<script src="js/mazes.js"></script>
	<script src="js/draw.js"></script>
	<script src="js/worker.js"></script>
	<script src="js/solution.js"></script>
	<script src="js/engine.js"></script>
	<script>
		const editor = ace.edit('editor');
		editor.setTheme('ace/theme/monokai');
		editor.session.setMode("ace/mode/javascript");
		const get_solution = () => `
			(() => {
				${editor.getValue()}
				return step;
			})();
		`;

		const start = () => init_mazes().map((c, i) => play(c)(mazes[i], get_solution()));

		document.getElementById('start-btn').addEventListener('click', start);
	</script>
</body>
</html>
